openapi: 3.0.3
info:
  title: payment-service
  version: 0.1.0
paths:
  /health:
    get:
      summary: Health check
      responses:
        "200": { description: OK }
  /ready:
    get:
      summary: Readiness check
      responses:
        "200": { description: OK }
  /live:
    get:
      summary: Liveness check
      responses:
        "200": { description: OK }
  /metrics:
    get:
      summary: Prometheus metrics
      responses:
        "200": { description: OK }

  /api/v1/payments/internal/intents:
    post:
      summary: Create payment intent (internal)
      requestBody:
        required: true
        content:
          application/json:
            schema: { type: object }
      responses:
        "201": { description: Created }

  /api/v1/payments/admin/gateway-config:
    get:
      summary: Get gateway config (admin)
      responses:
        "200": { description: OK }
    put:
      summary: Upsert gateway config (admin)
      requestBody:
        required: true
        content:
          application/json:
            schema: { type: object }
      responses:
        "200": { description: OK }

  /api/v1/payments/me/intents/{intent_id}/initiate:
    post:
      summary: Initiate payment
      parameters:
        - in: path
          name: intent_id
          required: true
          schema: { type: string, format: uuid }
      responses:
        "200": { description: OK }

  /api/v1/payments/intents/{intent_id}/create-gateway-order:
    post:
      summary: Create Cashfree gateway order/session
      parameters:
        - in: path
          name: intent_id
          required: true
          schema: { type: string, format: uuid }
      responses:
        "200": { description: OK }
  /api/v1/payments/intents/{intent_id}/retry:
    post:
      summary: Retry Cashfree gateway order/session
      parameters:
        - in: path
          name: intent_id
          required: true
          schema: { type: string, format: uuid }
      responses:
        "200": { description: OK }
  /api/v1/payments/webhooks/mock:
    post:
      summary: Mock webhook (dev)
      requestBody:
        required: true
        content:
          application/json:
            schema: { type: object }
      responses:
        "200": { description: OK }

  /api/v1/payments/webhooks/cashfree:
    post:
      summary: Cashfree webhook
      responses:
        "200": { description: OK }

  /api/v1/payments/internal/jobs/reconcile-due:
    post:
      summary: Reconcile due pending intents (internal)
      responses:
        "200": { description: OK }

  /api/v1/payments/internal/offline/mark-order-paid:
    post:
      summary: Mark order paid offline (internal)
      requestBody:
        required: true
        content:
          application/json:
            schema: { type: object }
      responses:
        "201": { description: Created }

components: {}
